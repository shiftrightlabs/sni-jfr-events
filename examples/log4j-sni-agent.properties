# Log4j Configuration for SNI Agent in Kafka Broker
# Add these configurations to your Kafka broker's log4j.properties file

# SNI Agent Logger Configuration
# ===============================

# Set log level for SNI agent (INFO for production, DEBUG for troubleshooting)
log4j.logger.com.kafka.jfr.sni=INFO, sniAppender
log4j.additivity.com.kafka.jfr.sni=false

# Dedicated appender for SNI agent logs (optional - for separate log file)
log4j.appender.sniAppender=org.apache.log4j.RollingFileAppender
log4j.appender.sniAppender.File=${kafka.logs.dir}/sni-agent.log
log4j.appender.sniAppender.MaxFileSize=50MB
log4j.appender.sniAppender.MaxBackupIndex=10
log4j.appender.sniAppender.layout=org.apache.log4j.PatternLayout
log4j.appender.sniAppender.layout.ConversionPattern=[%d] %p [%X{component}] [%X{sni}] %m (%c)%n

# Alternative: Use Kafka's main log file
# ========================================
# Uncomment below to log to main Kafka log instead of separate file
# log4j.logger.com.kafka.jfr.sni=INFO, kafkaAppender

# Debug Mode Configuration
# ========================
# For troubleshooting, uncomment the following:
# log4j.logger.com.kafka.jfr.sni=DEBUG, sniAppender, console

# Performance Considerations
# ==========================
# For high-throughput environments, consider async appender:
log4j.appender.sniAsyncAppender=org.apache.log4j.AsyncAppender
log4j.appender.sniAsyncAppender.BufferSize=1000
log4j.appender.sniAsyncAppender.Blocking=false
log4j.appender.sniAsyncAppender.appenders=sniAppender

# Log Format Examples
# ===================
# Standard format:
# [2025-09-21 10:15:30,123] INFO [SNI-AGENT] [kafka-client.example.com] SNI captured: hostname=kafka-client.example.com, thread=kafka-network-thread-1, count=42 (com.kafka.jfr.sni.ProductionSNIAgentV2)

# With MDC context:
# [2025-09-21 10:15:30,123] INFO [component:SNI-AGENT] [sni:kafka-client.example.com] SNI capture milestone: 100 total captures

# Specific Log Levels for Different Operations
# =============================================
# Agent initialization - INFO
# SNI captures - DEBUG (or INFO every Nth capture)
# Errors - WARN/ERROR
# Statistics - DEBUG
# JFR operations - DEBUG/TRACE

# Integration with Kafka Logging
# ===============================
# The agent will automatically use Kafka's SLF4J binding
# No additional configuration needed for basic operation
# Logs will follow Kafka's log rotation and retention policies

# Monitoring Integration
# ======================
# For log aggregation systems (ELK, Splunk, etc.), parse patterns:
# - SNI hostname: Extract from [sni:xxx] or "hostname=xxx"
# - Capture count: Extract from "count=xxx"
# - Thread name: Extract from "thread=xxx"
# - Errors: Filter by " ERROR "